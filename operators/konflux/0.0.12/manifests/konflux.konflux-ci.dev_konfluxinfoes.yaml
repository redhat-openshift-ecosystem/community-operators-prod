apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  creationTimestamp: null
  name: konfluxinfoes.konflux.konflux-ci.dev
spec:
  group: konflux.konflux-ci.dev
  names:
    kind: KonfluxInfo
    listKind: KonfluxInfoList
    plural: konfluxinfoes
    singular: konfluxinfo
  scope: Cluster
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: KonfluxInfo is the Schema for the konfluxinfoes API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            default: {}
            description: KonfluxInfoSpec defines the desired state of KonfluxInfo.
            properties:
              banner:
                description: |-
                  Banner defines the configuration for the banner-content.yaml ConfigMap.
                  If not specified, an empty banner array will be used.
                properties:
                  items:
                    description: Items is the list of banners to display
                    items:
                      description: BannerItem contains individual banner configuration
                      properties:
                        dayOfMonth:
                          description: DayOfMonth is the day of month (1-31)
                          maximum: 31
                          minimum: 1
                          type: integer
                        dayOfWeek:
                          description: DayOfWeek is the day of week (0-6, 0=Sunday)
                          maximum: 6
                          minimum: 0
                          type: integer
                        endTime:
                          description: EndTime is the end time in HH:mm format (required
                            if date fields are set)
                          type: string
                        month:
                          description: Month is the month (1-12)
                          maximum: 12
                          minimum: 1
                          type: integer
                        startTime:
                          description: StartTime is the start time in HH:mm format
                            (required if date fields are set)
                          type: string
                        summary:
                          description: Summary is the banner text (5-500 chars, supports
                            Markdown)
                          maxLength: 500
                          minLength: 5
                          type: string
                        timeZone:
                          description: TimeZone is the IANA timezone (optional, defaults
                            to UTC)
                          type: string
                        type:
                          description: Type is the banner type (info, warning, danger)
                          enum:
                          - info
                          - warning
                          - danger
                          type: string
                        year:
                          description: Year is the year for one-time banners
                          type: integer
                      required:
                      - summary
                      - type
                      type: object
                    type: array
                type: object
              clusterConfig:
                description: |-
                  ClusterConfig defines cluster-wide key-value configuration.
                  The key-value pairs will be stored in a ConfigMap named "cluster-config"
                  in the "konflux-info" namespace, readable by all authenticated users.
                  User-provided values take precedence over auto-detected values.
                properties:
                  data:
                    description: |-
                      Data contains structured cluster-wide configuration values.
                      These values will be stored in the "cluster-config" ConfigMap in the "konflux-info" namespace.
                      The ConfigMap keys are stable and part of the public API consumed by PipelineRuns.
                      WARNING: Changing field names or JSON tags is a BREAKING CHANGE that will affect
                      all PipelineRuns reading from the ConfigMap. Field names must remain stable.
                    properties:
                      defaultOIDCIssuer:
                        description: DefaultOIDCIssuer is the default OIDC issuer
                          URL.
                        type: string
                      enableKeylessSigning:
                        description: |-
                          EnableKeylessSigning determines if pipelines should perform/validate keyless signing.
                          When nil, the key is omitted from the ConfigMap (unset).
                        type: boolean
                      fulcioExternalUrl:
                        description: FulcioExternalUrl is the external Fulcio URL.
                        type: string
                      fulcioInternalUrl:
                        description: FulcioInternalUrl is the internal Fulcio URL.
                        type: string
                      rekorExternalUrl:
                        description: RekorExternalUrl is the external Rekor URL.
                        type: string
                      rekorInternalUrl:
                        description: RekorInternalUrl is the internal Rekor URL.
                        type: string
                      trustifyServerExternalUrl:
                        description: TrustifyServerExternalUrl is the external URL
                          for the Trustify server.
                        type: string
                      trustifyServerInternalUrl:
                        description: TrustifyServerInternalUrl is the internal URL
                          for the Trustify server.
                        type: string
                      tufExternalUrl:
                        description: TufExternalUrl is the external TUF URL.
                        type: string
                      tufInternalUrl:
                        description: TufInternalUrl is the internal TUF URL.
                        type: string
                    type: object
                type: object
              publicInfo:
                description: |-
                  PublicInfo defines the configuration for the info.json ConfigMap.
                  If not specified, default development values will be used.
                properties:
                  environment:
                    default: development
                    description: Environment is the environment type (development,
                      production, staging)
                    enum:
                    - development
                    - production
                    - staging
                    type: string
                  integrations:
                    description: Integrations contains integration configuration
                    properties:
                      github:
                        description: GitHub contains GitHub integration configuration
                        properties:
                          application_url:
                            description: ApplicationURL is the GitHub App installation
                              URL
                            type: string
                        required:
                        - application_url
                        type: object
                      image_controller:
                        description: ImageController contains image controller configuration
                        properties:
                          enabled:
                            description: Enabled indicates if image controller is
                              enabled
                            type: boolean
                          notifications:
                            description: Notifications contains notification configurations
                            items:
                              description: InfoNotificationConfig contains notification
                                configuration for info.json
                              properties:
                                config:
                                  description: |-
                                    Config contains method-specific configuration (as JSON).
                                    For webhook method, use: {"url": "https://webhook.example.com/endpoint"}
                                    For email method, use: {"email": "notifications@example.com"}
                                    Example webhook config:
                                      config:
                                        url: "https://webhook.example.com/build"
                                    Example email config:
                                      config:
                                        email: "team@example.com"
                                  x-kubernetes-preserve-unknown-fields: true
                                event:
                                  description: Event is the event type (e.g., "repo_push",
                                    "build_complete")
                                  type: string
                                method:
                                  description: Method is the notification method (e.g.,
                                    "webhook", "email")
                                  type: string
                                title:
                                  description: Title is the notification title
                                  type: string
                              required:
                              - config
                              - event
                              - method
                              - title
                              type: object
                            type: array
                        required:
                        - enabled
                        type: object
                      sbom_server:
                        description: SBOMServer contains SBOM server configuration
                        properties:
                          sbom_sha:
                            description: SBOMSha is the SBOM SHA URL
                            type: string
                          url:
                            description: URL is the SBOM content URL
                            type: string
                        required:
                        - sbom_sha
                        - url
                        type: object
                    type: object
                  rbac:
                    description: RBAC contains RBAC role definitions
                    items:
                      description: RBACRole contains RBAC role definition
                      properties:
                        description:
                          description: Description is the role description
                          type: string
                        displayName:
                          description: |-
                            DisplayName is the human-readable name displayed in the UI.
                            If not specified, defaults to the Name field.
                          type: string
                        name:
                          description: Name is the ClusterRole name (e.g., "konflux-admin-user-actions")
                          type: string
                      required:
                      - description
                      - name
                      type: object
                    type: array
                  statusPageUrl:
                    description: StatusPageUrl is the URL to the status page
                    type: string
                  visibility:
                    default: public
                    description: Visibility is the visibility level (public, private)
                    enum:
                    - public
                    - private
                    type: string
                required:
                - environment
                - visibility
                type: object
            type: object
          status:
            description: KonfluxInfoStatus defines the observed state of KonfluxInfo.
            properties:
              conditions:
                description: Conditions represent the latest available observations
                  of the KonfluxInfo state
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
            type: object
        required:
        - spec
        type: object
        x-kubernetes-validations:
        - message: KonfluxInfo CR must be named 'konflux-info'. Only one instance
            is allowed per cluster.
          rule: self.metadata.name == 'konflux-info'
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: null
  storedVersions: null

apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "operator.open-cluster-management.io/v1alpha1",
          "kind": "MulticlusterGlobalHub",
          "metadata": {
            "name": "multiclusterglobalhub"
          },
          "spec": {
            "storage": {
              "name": "storage-secret"
            },
            "transport": {
              "name": "transport-secret"
            }
          }
        }
      ]
    capabilities: Seamless Upgrades
    categories: Integration & Delivery,OpenShift Optional
    certified: "false"
    containerImage: quay.io/stolostron/multicluster-global-hub-operator:v0.5.0
    createdAt: "2022-08-23T20:00:31Z"
    description: Manages the installation and upgrade of the Multicluster Global Hub.
    operatorframework.io/suggested-namespace: open-cluster-management
    operators.operatorframework.io/builder: operator-sdk-v1.23.0
    operators.operatorframework.io/project_layout: go.kubebuilder.io/v3
    repository: https://github.com/stolostron/multicluster-global-hub
    support: Red Hat
  name: multicluster-global-hub-operator.v0.5.0
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - description: MulticlusterGlobalHub is the Schema for the multiclusterglobalhubs
        API
      displayName: Multicluster Global Hub
      kind: MulticlusterGlobalHub
      name: multiclusterglobalhubs.operator.open-cluster-management.io
      version: v1alpha1
  description: "Multicluster Global Hub Operator defines the configuration for multicluster
    global hub installation and upgrade with one custom resource.\n\n## Prerequisites\n\n-
    Red Hat Advanced Cluster Management for Kubernetes (RHACM) 2.5 or later needs
    to be installed.\n- PostgreSQL needs to be installed and you must create database
    for the multicluster global hub. You must create a secret named postgresql-secret
    that contains the database access credential in `open-cluster-management` namespace.
    You can run the following command to create the secret: \n\n```\nkubectl create
    secret generic storage-secret -n open-cluster-management \\\n  --from-literal=database_uri=<postgresql-uri>
    \n```\n>_Note:_ There is a sample script available [here](https://github.com/stolostron/multicluster-global-hub/tree/main/operator/config/samples/storage)
    to install postgres in `hoh-postgres` namespace and create the secret `storage-secret`
    in namespace `open-cluster-management` automatically. To override the secret namespace,
    set `TARGET_NAMESPACE` environment variable to the RHACM installation namespace
    before executing the script.\n\n- Kafka needs to be installed, and you must create
    two sections, `spec` and `status`. You need to create a secret named kafka-secret
    that contains the kafka access information should be created in `open-cluster-management`
    namespace. You can run the following command to create the secret: \n\n```\nkubectl
    create secret generic transport-secret -n open-cluster-management \\\n  --from-literal=bootstrap_server=<kafka-bootstrap-server-address>
    \\\n  --from-literal=CA=<CA-for-kafka-server>\n```\n >_Note:_ There is a sample
    script available [here](https://github.com/stolostron/multicluster-global-hub/tree/main/operator/config/samples/transport)
    to install kafka in `kafka` namespace and create the secret `transport-secret`
    in namespace `open-cluster-management` automatically. To override the secret namespace,
    set `TARGET_NAMESPACE` environment variable to the RHACM installation namespace
    before executing the script.\n\n## How to Install\n\nInstall the Multicluster
    Global Hub Operator by following the instructions that are displayed after you
    select the Install button. The operator must be installed in the same namespace
    as Red Hat Advanced Cluster Management for Kubernetes (RHACM), by default, in
    `open-cluster-management` namespace.\n\nA pod will be created in `open-cluster-management`
    namespace\n\n```\n$ kubectl get pods -n open-cluster-management\nNAME                                                             READY
    \  STATUS    RESTARTS   AGE\nmulticluster-global-hub-operator-5ccbbc878d-98fdp
    \               1/1     Running   0          19s\n```\n\nThe operator is now providing
    new Custom Resources Definitions: `multiclusterglobalhubs.operator.open-cluster-management.io`\n\n##
    Using the Multicluster Global Hub Operator\n\nAfter installing the operator, create
    an instance of the MulticlusterGlobalHub resource to install the Multicluster
    Global Hub.\n\nThe pods of Multicluster Global Hub are created in the `open-cluster-management`
    namespace:\n\n```\n$ kubectl get pods -n open-cluster-management\nNAME                                                             READY
    \  STATUS    RESTARTS   AGE\nmulticluster-global-hub-operator-5ccbbc878d-98fdp
    \               1/1     Running   0          56s\nmulticluster-global-hub-manager-7c55644568-mth8f
    \                1/1     Running   0          11s\nmulticluster-global-hub-rbac-77888b7dc4-z9vbp
    \                   1/1     Running   0          10s\n```\n"
  displayName: Multicluster Global Hub Operator
  icon:
  - base64data: PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTguNTEgMjU4LjUxIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2QxZDFkMTt9LmNscy0ye2ZpbGw6IzhkOGQ4Zjt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPkFzc2V0IDQ8L3RpdGxlPjxnIGlkPSJMYXllcl8yIiBkYXRhLW5hbWU9IkxheWVyIDIiPjxnIGlkPSJMYXllcl8xLTIiIGRhdGEtbmFtZT0iTGF5ZXIgMSI+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTI5LjI1LDIwQTEwOS4xLDEwOS4xLDAsMCwxLDIwNi40LDIwNi40LDEwOS4xLDEwOS4xLDAsMSwxLDUyLjExLDUyLjExLDEwOC40NSwxMDguNDUsMCwwLDEsMTI5LjI1LDIwbTAtMjBoMEM1OC4xNiwwLDAsNTguMTYsMCwxMjkuMjVIMGMwLDcxLjA5LDU4LjE2LDEyOS4yNiwxMjkuMjUsMTI5LjI2aDBjNzEuMDksMCwxMjkuMjYtNTguMTcsMTI5LjI2LTEyOS4yNmgwQzI1OC41MSw1OC4xNiwyMDAuMzQsMCwxMjkuMjUsMFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0xNzcuNTQsMTAzLjQxSDE0MS42NkwxNTQuOSw2NS43NmMxLjI1LTQuNC0yLjMzLTguNzYtNy4yMS04Ljc2SDEwMi45M2E3LjMyLDcuMzIsMCwwLDAtNy40LDZsLTEwLDY5LjYxYy0uNTksNC4xNywyLjg5LDcuODksNy40LDcuODloMzYuOUwxMTUuNTUsMTk3Yy0xLjEyLDQuNDEsMi40OCw4LjU1LDcuMjQsOC41NWE3LjU4LDcuNTgsMCwwLDAsNi40Ny0zLjQ4TDE4NCwxMTMuODVDMTg2Ljg2LDEwOS4yNCwxODMuMjksMTAzLjQxLDE3Ny41NCwxMDMuNDFaIi8+PC9nPjwvZz48L3N2Zz4=
    mediatype: image/svg+xml
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - policy.open-cluster-management.io
          resources:
          - policies
          - policies/status
          - policies/finalizers
          - placementbindings
          - placementbindings/finalizers
          verbs:
          - get
          - list
          - watch
          - update
          - patch
        - apiGroups:
          - apps.open-cluster-management.io
          resources:
          - placementrules
          - placementrules/status
          - subscriptionstatuses
          - subscriptionstatuses/status
          - subscriptionreports
          - subscriptionreports/status
          - subscriptions/finalizers
          verbs:
          - create
          - get
          - list
          - watch
          - update
          - patch
          - delete
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - placements
          - placements/finalizers
          - placements/status
          - placementdecisions
          - placementdecisions/status
          verbs:
          - create
          - get
          - list
          - watch
          - update
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - pods
          - configmaps
          - events
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclustersets
          - managedclustersets/finalizers
          - managedclustersetbindings
          - managedclustersetbindings/finalizers
          - placements
          - placements/finalizers
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - apps.open-cluster-management.io
          resources:
          - placementrules
          - placementrules/finalizers
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - apps.open-cluster-management.io
          resources:
          - subscriptions
          - channels
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - app.k8s.io
          resources:
          - applications
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - apiextensions.k8s.io
          resources:
          - customresourcedefinitions
          verbs:
          - get
        - apiGroups:
          - admissionregistration.k8s.io
          resourceNames:
          - ocm-mutating-webhook
          resources:
          - mutatingwebhookconfigurations
          verbs:
          - get
          - update
          - patch
        - apiGroups:
          - operator.open-cluster-management.io
          resources:
          - multiclusterhubs
          verbs:
          - get
          - update
          - patch
          - list
          - watch
        - apiGroups:
          - multicluster.openshift.io
          resources:
          - multiclusterengines
          verbs:
          - get
          - update
          - patch
          - list
          - watch
        - apiGroups:
          - apps.open-cluster-management.io
          resources:
          - subscriptions
          - channels
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - jobs
          - services
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - hive.openshift.io
          resources:
          - clusterimagesets
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - authentication.k8s.io
          resources:
          - tokenreviews
          verbs:
          - create
        - apiGroups:
          - config.openshift.io
          - console.openshift.io
          - project.openshift.io
          - tower.ansible.com
          resources:
          - infrastructures
          - consolelinks
          - projects
          - featuregates
          - ansiblejobs
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - inventory.open-cluster-management.io
          resources:
          - baremetalassets
          verbs:
          - list
          - watch
        - apiGroups:
          - certificates.k8s.io
          resources:
          - certificatesigningrequests
          verbs:
          - list
          - watch
        - apiGroups:
          - hive.openshift.io
          resources:
          - clusterclaims
          - clusterdeployments
          - clusterpools
          - clusterimagesets
          - clusterprovisions
          - clusterdeprovisions
          - machinepools
          verbs:
          - list
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclusters
          - managedclustersets
          - managedclustersetbindings
          - clustercurators
          - placementdecisions
          - placements
          verbs:
          - list
          - watch
        - apiGroups:
          - internal.open-cluster-management.io
          resources:
          - managedclusterinfos
          verbs:
          - list
          - watch
        - apiGroups:
          - discovery.open-cluster-management.io
          resources:
          - discoveryconfigs
          - discoveredclusters
          verbs:
          - list
          - watch
        - apiGroups:
          - wgpolicyk8s.io
          resources:
          - policyreports
          verbs:
          - list
          - watch
        - apiGroups:
          - submarineraddon.open-cluster-management.io
          resources:
          - submarinerconfigs
          verbs:
          - list
          - watch
        - apiGroups:
          - extensions.hive.openshift.io
          resources:
          - agentclusterinstalls
          verbs:
          - list
          - watch
        - apiGroups:
          - agent-install.openshift.io
          resources:
          - agents
          - infraenvs
          verbs:
          - list
          - watch
        - apiGroups:
          - metal3.io
          resources:
          - baremetalhosts
          verbs:
          - list
          - watch
        - apiGroups:
          - monitoring.coreos.com
          resources:
          - prometheusrules
          - servicemonitors
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - operators.coreos.com
          resources:
          - clusterserviceversions
          verbs:
          - get
          - update
          - patch
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - configmaps/finalizers
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - ""
          resourceNames:
          - policy-encryption-key
          resources:
          - secrets
          verbs:
          - patch
        - apiGroups:
          - '*'
          resources:
          - '*'
          verbs:
          - get
          - list
        - apiGroups:
          - '*'
          resources:
          - '*/finalizers'
          verbs:
          - update
        - apiGroups:
          - apps.open-cluster-management.io
          resources:
          - '*'
          verbs:
          - get
          - list
          - update
          - watch
        - apiGroups:
          - authorization.k8s.io
          resources:
          - subjectaccessreviews
          verbs:
          - create
        - apiGroups:
          - policy.open-cluster-management.io
          resources:
          - '*'
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - view.open-cluster-management.io
          resources:
          - managedclusterviews
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - addon.open-cluster-management.io
          resourceNames:
          - cert-policy-controller
          - config-policy-controller
          - governance-policy-framework
          - iam-policy-controller
          resources:
          - managedclusteraddons/status
          verbs:
          - patch
          - update
        - apiGroups:
          - certificates.k8s.io
          resources:
          - certificatesigningrequests
          verbs:
          - create
          - update
        - apiGroups:
          - certificates.k8s.io
          resources:
          - certificatesigningrequests/approval
          verbs:
          - create
          - update
          - watch
        - apiGroups:
          - certificates.k8s.io
          resources:
          - signers
          verbs:
          - approve
        - apiGroups:
          - coordination.k8s.io
          resourceNames:
          - cert-policy-controller
          - config-policy-controller
          - governance-policy-framework
          - iam-policy-controller
          resources:
          - leases
          verbs:
          - patch
          - update
          - watch
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - create
        - apiGroups:
          - rbac.authorization.k8s.io
          resourceNames:
          - open-cluster-management:cert-policy-controller-hub
          - open-cluster-management:config-policy-controller-hub
          - open-cluster-management:iam-policy-controller-hub
          - open-cluster-management:policy-framework-hub
          resources:
          - clusterroles
          verbs:
          - patch
        - apiGroups:
          - rbac.authorization.k8s.io
          resourceNames:
          - open-cluster-management:cert-policy-controller-hub
          - open-cluster-management:config-policy-controller-hub
          - open-cluster-management:iam-policy-controller-hub
          - open-cluster-management:policy-framework-hub
          resources:
          - rolebindings
          verbs:
          - patch
        - apiGroups:
          - tower.ansible.com
          resources:
          - ansiblejobs
          verbs:
          - deletecollection
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - namespaces
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - serviceaccounts
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - services
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - addon.open-cluster-management.io
          resources:
          - clustermanagementaddons
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - addon.open-cluster-management.io
          resources:
          - managedclusteraddons
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - apps
          resources:
          - deployments
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - batch
          resources:
          - jobs
          verbs:
          - create
          - delete
          - get
          - list
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - hypershiftdeployments
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclusters
          verbs:
          - get
          - list
          - update
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclustersetbindings
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclustersets/bind
          verbs:
          - create
          - delete
        - apiGroups:
          - cluster.open-cluster-management.io
          resources:
          - managedclustersets/join
          verbs:
          - create
          - delete
        - apiGroups:
          - networking.k8s.io
          resources:
          - ingresses
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - networking.k8s.io
          resources:
          - networkpolicies
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - operator.open-cluster-management.io
          resources:
          - multiclusterglobalhubs
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - operator.open-cluster-management.io
          resources:
          - multiclusterglobalhubs/finalizers
          verbs:
          - update
        - apiGroups:
          - operator.open-cluster-management.io
          resources:
          - multiclusterglobalhubs/status
          verbs:
          - get
          - patch
          - update
        - apiGroups:
          - packages.operators.coreos.com
          resources:
          - packagemanifests
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - clusterrolebindings
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - clusterroles
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - rolebindings
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - roles
          verbs:
          - create
          - delete
          - get
          - list
          - update
          - watch
        - apiGroups:
          - work.open-cluster-management.io
          resources:
          - manifestworks
          verbs:
          - create
          - delete
          - deletecollection
          - get
          - list
          - patch
          - update
          - watch
        serviceAccountName: multicluster-global-hub-operator
      deployments:
      - label:
          name: multicluster-global-hub-operator
        name: multicluster-global-hub-operator
        spec:
          replicas: 1
          selector:
            matchLabels:
              name: multicluster-global-hub-operator
          strategy: {}
          template:
            metadata:
              annotations:
                kubectl.kubernetes.io/default-container: multicluster-global-hub-operator
              labels:
                name: multicluster-global-hub-operator
            spec:
              containers:
              - args:
                - --leader-elect
                command:
                - multicluster-global-hub-operator
                env:
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: OPERAND_IMAGE_MULTICLUSTER_GLOBAL_HUB_MANAGER
                  value: quay.io/stolostron/multicluster-global-hub-manager:v0.5.0
                - name: OPERAND_IMAGE_MULTICLUSTER_GLOBAL_HUB_AGENT
                  value: quay.io/stolostron/multicluster-global-hub-agent:v0.5.0
                - name: OPERAND_IMAGE_MULTICLUSTER_GLOBAL_HUB_OPERATOR
                  value: quay.io/stolostron/multicluster-global-hub-operator:v0.5.0
                image: quay.io/stolostron/multicluster-global-hub-operator:v0.5.0
                livenessProbe:
                  httpGet:
                    path: /healthz
                    port: 8081
                  initialDelaySeconds: 15
                  periodSeconds: 20
                name: multicluster-global-hub-operator
                readinessProbe:
                  httpGet:
                    path: /readyz
                    port: 8081
                  initialDelaySeconds: 5
                  periodSeconds: 10
                resources:
                  limits:
                    cpu: 500m
                    memory: 512Mi
                  requests:
                    cpu: 10m
                    memory: 64Mi
                securityContext:
                  allowPrivilegeEscalation: false
              securityContext:
                runAsNonRoot: true
              serviceAccountName: multicluster-global-hub-operator
              terminationGracePeriodSeconds: 10
      permissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
        - apiGroups:
          - ""
          resources:
          - pods
          - services
          - services/finalizers
          - endpoints
          - persistentvolumeclaims
          - events
          - configmaps
          - secrets
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - apps
          resources:
          - deployments
          - daemonsets
          - replicasets
          - statefulsets
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - monitoring.coreos.com
          resources:
          - servicemonitors
          verbs:
          - get
          - create
        - apiGroups:
          - apps
          resourceNames:
          - multicluster-global-hub-manager
          resources:
          - deployments/finalizers
          verbs:
          - update
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - create
          - update
          - delete
        serviceAccountName: multicluster-global-hub-operator
    strategy: deployment
  installModes:
  - supported: true
    type: OwnNamespace
  - supported: true
    type: SingleNamespace
  - supported: false
    type: MultiNamespace
  - supported: false
    type: AllNamespaces
  keywords:
  - multicluster-global-hub
  - multiple-hubs
  links:
  - name: Multicluster Global Hub Operator
    url: https://github.com/stolostron/multicluster-global-hub
  maintainers:
  - email: acm-contact@redhat.com
    name: acm-contact
  maturity: alpha
  provider:
    name: Red Hat, Inc
    url: https://github.com/stolostron/multicluster-global-hub
  version: 0.5.0
